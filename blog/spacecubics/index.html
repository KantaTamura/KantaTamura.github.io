<!doctype html><html lang=ja><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="light dark" name=color-scheme><title>space cubicsでRaspberry Pi組み込み開発をした話</title><link href=/img/favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=/img/favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=/img/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><style>body{--primary-color:#5871a2;--primary-pale-color:#5871a210;--text-color:#3c4043;--text-pale-color:#a3a5a9;--bg-color:#fff;--highlight-mark-color:#5f75b035;--blockquote-color:#8e8d91;--callout-note-color:#5871a2;--callout-important-color:#8062b0;--callout-warning-color:#936e51;--callout-alert-color:#bc5252;--callout-question-color:#477389;--callout-tip-color:#3c8460}body.dark{--primary-color:#5d77ac;--primary-pale-color:#5d77ac20;--text-color:#9197a5;--text-pale-color:#656a74;--bg-color:#18191b;--highlight-mark-color:#5f75b035;--blockquote-color:#747983;--callout-note-color:#5d77ac;--callout-important-color:#8062b0;--callout-warning-color:#936e51;--callout-alert-color:#bc5252;--callout-question-color:#477389;--callout-tip-color:#3c8460}body{--main-font:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--code-font:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--homepage-max-width:768px;--main-max-width:768px;--avatar-size:56px;--homepage-font-size:16px;--homepage-line-height:1.75;--paragraph-font-size:16px;--paragraph-line-height:1.75;--aside-font-size:15px;--img-border-radius:0px;--detail-border-radius:0px;--dark-mode-img-brightness:.75;--dark-mode-chart-brightness:.75;--inline-code-border-radius:2px;--inline-code-bg-color:var(--primary-pale-color);--block-code-border-radius:0px;--block-code-border-color:var(--primary-color);--detail-border-color:var(--primary-color)}</style><link href=/main.css rel=stylesheet><link href=/hl-light.css id=hl rel=stylesheet><link crossorigin href=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css integrity=sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+ rel=stylesheet><script crossorigin defer integrity=sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js></script><script crossorigin defer integrity=sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js></script><script crossorigin defer integrity=sha384-HORx6nWi8j5/mYA+y57/9/CZc5z8HnEw4WUZWy5yOn9ToKBv1l58vJaufFAn9Zzi src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js></script><script>document.addEventListener(`DOMContentLoaded`,(()=>{let b=`\$`,a=`\$\$`;renderMathInElement(document.body,{delimiters:[{left:a,right:a,display:!0},{left:b,right:b,display:!1},{left:`\\\\(`,right:`\\\\)`,display:!1},{left:`\\\\[`,right:`\\\\]`,display:!0}],throwOnError:!1})}))</script><body class=post><script>const theme=sessionStorage.getItem(`theme`);const match=window.matchMedia(`(prefers-color-scheme: dark)`).matches;if(theme&&theme==`dark`||!theme&&match){document.body.classList.add(`dark`);const a=document.querySelector(`link#hl`);if(a)a.href=`/hl-dark.css`}</script><header class=blur><div id=header-wrapper><nav><a class=instant href=/>i0ta</a><button aria-label="toggle expand" class=separator id=toggler>::</button><span class="wrap left fold">{</span><a class=instant href=/blog>blog</a><span class="wrap-separator fold">,</span><a class="instant fold" href=/projects>projects</a><span class="wrap-separator fold">,</span><a class="instant fold" href=/about>about</a><span class="wrap right fold">} ;</span></nav><div id=btns><a aria-label="rss feed" href=/feed.xml id=rss-btn><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M3 17C5.20914 17 7 18.7909 7 21H3V17ZM3 10C9.07513 10 14 14.9249 14 21H12C12 16.0294 7.97056 12 3 12V10ZM3 3C12.9411 3 21 11.0589 21 21H19C19 12.1634 11.8366 5 3 5V3Z" fill=currentColor></path></svg></a><button aria-label="theme switch" id=theme-toggle><span class=moon-icon><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill=currentColor></path></svg></span> <span class=sun-icon><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" fill=currentColor></path></svg></span></button><button aria-label="table of content" id=toc-toggle><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M3 4H21V6H3V4ZM3 11H15V13H3V11ZM3 18H21V20H3V18Z" fill=currentColor></path></svg></button></div></div></header><dialog id=rss-mask><div><a href=https://kantatamura.github.io//feed.xml>https://kantatamura.github.io//feed.xml</a><button data-check-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z" fill="currentColor"></path></svg>' data-copy-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>' aria-label=copy autofocus data-link=https://kantatamura.github.io//feed.xml><svg viewbox="0 0 24 24" height=20 width=20 xmlns=http://www.w3.org/2000/svg><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill=currentColor></path></svg></button></div></dialog><div id=wrapper><div id=blank></div><aside><nav><ul><li><a class=h2 href=#space-cubicstoha>space cubicsとは？</a><li><a class=h2 href=#he-wositaka>何をしたか？</a> <ul><li><a class=h3 href=#kitukake>きっかけ</a><li><a class=h3 href=#ying-mu-cai-yong-made>応募～採用まで</a><li><a class=h3 href=#8yue-zhong>8月中</a><li><a class=h3 href=#9yue-zhong>9月中</a></ul><li><a class=h2 href=#xue-ndakoto>学んだこと</a><li><a class=h2 href=#gan-xiang>感想</a> <ul><li><a class=h3 href=#zhui-ji-kun-tutakoto>追記 - 困ったこと</a></ul><li><a class=h2 href=#owarini>おわりに</a></ul></nav><button aria-label="back to top" id=back-to-top><svg viewbox="0 0 24 24" height=24 width=24 xmlns=http://www.w3.org/2000/svg><path d="M11.9997 10.8284L7.04996 15.7782L5.63574 14.364L11.9997 8L18.3637 14.364L16.9495 15.7782L11.9997 10.8284Z" fill=currentColor></path></svg></button></aside><main><div><div data-check-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z" fill="currentColor"></path></svg>' data-copy-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z" fill="currentColor"></path></svg>' id=copy-cfg style=display:none></div><article data-backlink-icon='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M9.41421 8L18.0208 16.6066L16.6066 18.0208L8 9.41421V17H6V6H17V8H9.41421Z" fill="currentColor"></path></svg>' class=prose><h1>space cubicsでRaspberry Pi組み込み開発をした話</h1><div id=post-info><div id=date><span id=publish>2023-11-14</span></div><div id=tags><a class=instant href=https://kantatamura.github.io//tags/spacecubics><span>#</span>spacecubics</a></div></div><p><a rel="nofollow noreferrer" href=https://zenn.dev/117324/articles/3f7ec8879660ed>Zennの記事</a>もよろしくお願いします!!<hr><h1 id=space-cubicstoha>space cubicsとは？<a aria-label="Anchor link for: space-cubicstoha" class=zola-anchor href=#space-cubicstoha style=visibility:hidden></a></h1><p><a rel="nofollow noreferrer" href=https://spacecubics.com/><strong>space cubics</strong></a>さんはJAXA発のベンチャー企業で、ごりごりの宇宙屋さんというよりも、宇宙でも問題なく動く高品質なプロセッサを開発している会社です。<p>ソフトウェア・FPGA・回路設計それぞれのプロフェッショナルが在籍していて、協力しあって素晴らしい製品を開発しています。<h1 id=he-wositaka>何をしたか？<a aria-label="Anchor link for: he-wositaka" class=zola-anchor href=#he-wositaka style=visibility:hidden></a></h1><p>2023年8月からCubeSat SC-Sat1という小型衛星に乗せるRaspberry Piボード (下図：ZeroとPicoが乗っている) の開発を行うインターンをさせていただきました。<figure><img alt=SC-Sat1 src=https://storage.googleapis.com/zenn-user-upload/14b357f1ffd5-20231030.jpg><figcaption>SC-Sat1</figcaption></figure><figure><img alt=scsat1-rpi src=https://storage.googleapis.com/zenn-user-upload/a837e827b95d-20230927.jpg><figcaption>scsat1-rpi</figcaption></figure><p>このRaspberry Piモジュールは、SC-Sat1のカメラモジュールとして機能し、下記のミッションを達成するために開発が行われました。<ul><li>宇宙で写真撮影を行い、指定した写真をdownlinkする<li>Raspberry Pi Zero<sup class=footnote-reference><a href=#1>1</a></sup> / Pico<sup class=footnote-reference><a href=#2>2</a></sup> の放射線耐性を確認する<li>SC Busのセンサーノードとして、Raspberry Pi Picoを使用する</ul><p>メインのコンピュータとZero間はCAN Bus、ZeroとPico間はUARTで接続されており、その上を<a rel="nofollow noreferrer" href=https://github.com/libcsp/libcsp>CSP (Cubesat Space Protocol)</a>を載せたパケットが通信を行います。<p>僕は主にこの通信周りに関わりました。成果は<a rel="nofollow noreferrer" href=https://github.com/spacecubics/scsat1-rpi>このリポジトリ</a>にあります。<h2 id=kitukake>きっかけ<a aria-label="Anchor link for: kitukake" class=zola-anchor href=#kitukake style=visibility:hidden></a></h2><p>7月末で院試が終了し、夏休みにはインターンを経験したいと考えていました。 そのとき、<a rel="nofollow noreferrer" href=https://twitter.com/KOBA789/status/1669729522663714816>KOBA789さんのツイート</a>を見かけ、「基板カッコいいなぁ、触ってみたいなぁ」と感じ、応募しました！ (低レイヤーのインターンがめずらしいというのも理由の1つです笑)<p>正直に言うと、宇宙については全くの未経験でしたが、高専の授業や趣味でRaspberry Piに触れた経験はあったので、不安と期待が入り混じった気持ちでした笑<h2 id=ying-mu-cai-yong-made>応募～採用まで<a aria-label="Anchor link for: ying-mu-cai-yong-made" class=zola-anchor href=#ying-mu-cai-yong-made style=visibility:hidden></a></h2><p>TwitterのDMが開放されていなかったため、ホームページのお問い合わせフォームを使って連絡を取りました。すぐに返信があり、meetで面談することになりました。<p>技術系のインターンの面接は初めての経験で、緊張しましたが、面談ではRaspberry Piを触ったことがあること、低レイヤーに興味があること、高専で作成した作品についてなどを30分ほど話したかなと思います。<p>面談から約1週間後、採用のメールを受け取りました！とてもうれしかったですが、応募者が4名全員採用されたようです笑。インターン初年度で、来る者拒まずという感じだったと後で聞きました笑<h2 id=8yue-zhong>8月中<a aria-label="Anchor link for: 8yue-zhong" class=zola-anchor href=#8yue-zhong style=visibility:hidden></a></h2><h3 id=raspberrypi-osshang-denokai-fa>RaspberryPi OS上での開発<a aria-label="Anchor link for: raspberrypi-osshang-denokai-fa" class=zola-anchor href=#raspberrypi-osshang-denokai-fa style=visibility:hidden></a></h3><p>Zeroはリソースが潤沢なので、Linuxを動かすのですが、組み込みLinuxを作成するための<a rel="nofollow noreferrer" href=https://www.yoctoproject.org/>Yocto</a>というプロジェクトを用いました。<p>Yoctoはレシピの作成など、ややこしい部分が多いため、まずはRaspberryPi OS上で実装し、Yoctoに移植する形で開発がスタートしました。<p>僕がRaspberryPi OS上で行ったことは下記の内容です。<details><summary><span>ZeroがCAN Controller (MCP2517FD) を認識できるようにする</span></summary> <p>使用したいデバイス情報は<a rel="nofollow noreferrer" href=https://github.com/raspberrypi/linux>RaspberryPi OSカーネル</a>に組み込まれているため、使用するように <code>config.txt</code> を書き換えます。</p> <pre class=z-code><code><span class="z-text z-plain">dtparam=spi=on
</span><span class="z-text z-plain">dtoverlay=mcp251xfd,oscillator=20000000,interrupt=25
</span></code></pre> <p><code>MCP251xFD</code> というデバイスツリーを適切なパラメータ (発振周波数や割り込みGPIOピン) を与えて有効化します。</p> <p>このようにすると、 <code>ip</code> コマンドなどで CANインターフェースが表示され、RaspberryPi OSからCAN通信を行うことができるようになります。</p></details><details><summary><span>ZeroとPC間でCAN通信が行えることを確認する</span></summary> <p>通常のPCはCANインターフェースを持たないので、<a rel="nofollow noreferrer" href=https://www.microchip.com/en-us/development-tool/apgdt002>MicrochipのCAN bus analyzer</a>を用います。</p> <p>Windows環境よりもLinux環境のほうが後々便利そうなので、WSL (Windows Subsystem for Linux) を用いて環境を整備しました。(次節)</p> <pre class="language-sh z-code" data-lang=sh><code class=language-sh data-lang=sh><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">$</span></span><span class="z-meta z-function-call z-arguments z-shell"> cangen can0</span>
</span></code></pre> <pre class="language-sh z-code" data-lang=sh><code class=language-sh data-lang=sh><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">$</span></span><span class="z-meta z-function-call z-arguments z-shell"> candump can0</span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">can0</span></span><span class="z-meta z-function-call z-arguments z-shell">  0ED   <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>8<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>  37 D0 12 66 BB 9F 61 0D</span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">can0</span></span><span class="z-meta z-function-call z-arguments z-shell">  5EB   <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>8<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>  02 B6 4B 50 F7 CC CF 02</span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">can0</span></span><span class="z-meta z-function-call z-arguments z-shell">  07E   <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>8<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>  3A E2 A8 2C 26 BE 3F 6C</span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">can0</span></span><span class="z-meta z-function-call z-arguments z-shell">  68F   <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>8<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>  42 00 1E 69 E4 6A 87 37</span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">can0</span></span><span class="z-meta z-function-call z-arguments z-shell">  2A7   <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>2<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>  17 FE</span>
</span><span class="z-source z-shell z-bash">  <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">can0</span></span><span class="z-meta z-function-call z-arguments z-shell">  57B   <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>1<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>  AB</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">...</span></span>
</span></code></pre> <p>上記のログの用にCSPの下位プロトコルであるCANで疎通することを確認しました。</p></details><details><summary><span>Zeroでlibcspのexampleコードを動かす</span></summary> <p><a rel="nofollow noreferrer" href=https://github.com/libcsp/libcsp>CSP</a>はCubesatなどの小規模なネットワーク間で通信を行うためのプロトコルで、現在も開発が盛んなOSSです。(サンプルプログラムが動かなくなることもしばしば...笑)</p> <p>とりあえずサンプルプログラムを動かしてみようと思い、exampleフォルダ内のコード (<code>csp-server-client</code>) を動かしてみました。</p> <p>現在のバージョンでは治っていますが、当時は自身のIDを設定できないといった不具合があり、動かすまで苦戦しました。</p> <p>ビルドシステムは <code>waf</code> <code>mason</code> <code>cmake</code> の３つあり、今回は <code>waf</code> を用いてビルドしました。</p> <pre class=z-code><code><span class="z-text z-plain">$ ./waf configure --enable-examples --with-driver-usart=linux --with-os=posix --enable-can-socketcan build
</span></code></pre> <p>ビルドが成功すれば、 <code>csp-server-client</code> という実行ファイルが生成されているはずで、 <code>-c can0</code> とCANインターフェースを指定すればCANを用いたCSP通信が可能です。</p></details><details><summary><span>details ZeroとPC間でCSP通信が行えることを確認する</span></summary> <p>RaspberryPi ZeroとWSLそれぞれでlibcspのexampleをビルドし、 <code>csp-server-client</code> を動かせる状態になれば、下記のように疎通が確認できるはずです。</p> <pre class="language-sh z-code" data-lang=sh><code class=language-sh data-lang=sh><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">$</span></span><span class="z-meta z-function-call z-arguments z-shell"> ./build/examples/csp_server_client<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>c</span> can0<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>a</span> 10<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>r</span> 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Initialising</span></span><span class="z-meta z-function-call z-arguments z-shell"> CSPINIT CAN: device: <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>can0<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>, bitrate: 0, promisc: 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Connection</span></span><span class="z-meta z-function-call z-arguments z-shell"> table</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[00</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x55a505cbebe0] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (17</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[01</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x55a505cbecf0] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (18</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[02</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x55a505cbee00] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (19</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[03</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x55a505cbef10] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (20</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[04</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x55a505cbf020] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (21</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[05</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x55a505cbf130] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (22</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[06</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x55a505cbf240] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (23</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[07</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x55a505cbf350] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (24</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Interfaces</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">LOOP</span></span><span class="z-meta z-function-call z-arguments z-shell">       addr: 0 netmask: 14 mtu: 0</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">tx:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 00000 rx: 00000 txe: 00000 rxe: 00000</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">drop:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 00000 autherr: 00000 frame: 00000</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">txb:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0 (0B</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">rxb:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0 (0B</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">CAN</span></span><span class="z-meta z-function-call z-arguments z-shell">        addr: 10 netmask: 0 mtu: 248</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">tx:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 00000 rx: 00000 txe: 00000 rxe: 00000</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">drop:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 00000 autherr: 00000 frame: 00000</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">txb:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0 (0B</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">rxb:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0 (0B</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Route</span></span><span class="z-meta z-function-call z-arguments z-shell"> table</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0/0</span></span><span class="z-meta z-function-call z-arguments z-shell"> CAN</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Client</span></span><span class="z-meta z-function-call z-arguments z-shell"> task startedPing address: 20, result<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>1</span> <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>mS<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">reboot</span></span><span class="z-meta z-function-call z-arguments z-shell"> system request sent to address: 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Ping</span></span><span class="z-meta z-function-call z-arguments z-shell"> address: 20, result 10 <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>mS<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">reboot</span></span><span class="z-meta z-function-call z-arguments z-shell"> system request sent to address: 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Ping</span></span><span class="z-meta z-function-call z-arguments z-shell"> address: 20, result 50 <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>mS<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">reboot</span></span><span class="z-meta z-function-call z-arguments z-shell"> system request sent to address: 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Ping</span></span><span class="z-meta z-function-call z-arguments z-shell"> address: 20, result<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>1</span> <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>mS<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">reboot</span></span><span class="z-meta z-function-call z-arguments z-shell"> system request sent to address: 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Ping</span></span><span class="z-meta z-function-call z-arguments z-shell"> address: 20, result<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>1</span> <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>mS<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">reboot</span></span><span class="z-meta z-function-call z-arguments z-shell"> system request sent to address: 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Ping</span></span><span class="z-meta z-function-call z-arguments z-shell"> address: 20, result 98 <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>mS<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">reboot</span></span><span class="z-meta z-function-call z-arguments z-shell"> system request sent to address: 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Ping</span></span><span class="z-meta z-function-call z-arguments z-shell"> address: 20, result<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>1</span> <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>mS<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">reboot</span></span><span class="z-meta z-function-call z-arguments z-shell"> system request sent to address: 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Ping</span></span><span class="z-meta z-function-call z-arguments z-shell"> address: 20, result<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>1</span> <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>mS<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">reboot</span></span><span class="z-meta z-function-call z-arguments z-shell"> system request sent to address: 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">...</span></span>
</span></code></pre> <pre class="language-sh z-code" data-lang=sh><code class=language-sh data-lang=sh><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">$</span></span><span class="z-meta z-function-call z-arguments z-shell"> ./build/examples/csp_server_client<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>c</span> can0<span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>a</span> 20</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Initialising</span></span><span class="z-meta z-function-call z-arguments z-shell"> CSPINIT CAN: device: <span class="z-keyword z-control z-regexp z-set z-begin z-shell">[</span>can0<span class="z-keyword z-control z-regexp z-set z-end z-shell">]</span>, bitrate: 0, promisc: 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Connection</span></span><span class="z-meta z-function-call z-arguments z-shell"> table</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[00</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x2d438] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (17</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[01</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x2d4e8] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (18</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[02</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x2d598] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (19</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[03</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x2d648] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (20</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[04</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x2d6f8] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (21</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[05</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x2d7a8] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (22</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[06</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x2d858] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (23</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">[07</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0x2d908] S:0, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span>, 0 -<span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> <span class="z-constant z-numeric z-integer z-decimal z-file-descriptor z-shell">0</span> (24</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">fl</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Interfaces</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">LOOP</span></span><span class="z-meta z-function-call z-arguments z-shell">       addr: 0 netmask: 14 mtu: 0</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">tx:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 00000 rx: 00000 txe: 00000 rxe: 00000</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">drop:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 00000 autherr: 00000 frame: 00000</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">txb:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0 (0B</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">rxb:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0 (0B</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">CAN</span></span><span class="z-meta z-function-call z-arguments z-shell">        addr: 20 netmask: 0 mtu: 248</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">tx:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 00000 rx: 00000 txe: 00000 rxe: 00000</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">drop:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 00000 autherr: 00000 frame: 00000</span>
</span><span class="z-source z-shell z-bash">           <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">txb:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0 (0B</span><span class="z-meta z-function-call z-shell"></span>) <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">rxb:</span></span><span class="z-meta z-function-call z-arguments z-shell"> 0 (0B</span><span class="z-meta z-function-call z-shell"></span>)
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Route</span></span><span class="z-meta z-function-call z-arguments z-shell"> table</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">0/0</span></span><span class="z-meta z-function-call z-arguments z-shell"> CAN</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Server</span></span><span class="z-meta z-function-call z-arguments z-shell"> task started</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Packet</span></span><span class="z-meta z-function-call z-arguments z-shell"> received on MY_SERVER_PORT: Hello world A</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Packet</span></span><span class="z-meta z-function-call z-arguments z-shell"> received on MY_SERVER_PORT: Hello world B</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Packet</span></span><span class="z-meta z-function-call z-arguments z-shell"> received on MY_SERVER_PORT: Hello world C</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Packet</span></span><span class="z-meta z-function-call z-arguments z-shell"> received on MY_SERVER_PORT: Hello world D</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Packet</span></span><span class="z-meta z-function-call z-arguments z-shell"> received on MY_SERVER_PORT: Hello world E</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Packet</span></span><span class="z-meta z-function-call z-arguments z-shell"> received on MY_SERVER_PORT: Hello world F</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Packet</span></span><span class="z-meta z-function-call z-arguments z-shell"> received on MY_SERVER_PORT: Hello world G</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">Packet</span></span><span class="z-meta z-function-call z-arguments z-shell"> received on MY_SERVER_PORT: Hello world H</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">...</span></span>
</span></code></pre> <p>同時に送っているpingのRTTがおかしなことになっている場所がいくつかありますが、CSPで疎通が行えていることが確認できました。</p> <p>また、このサンプルコードは <code>reboot</code> コマンドを強制的に送りつけるので送信側に管理者権限があれば再起動をし続けるということに...笑</p></details><h3 id=wslkaracantong-xin-woxing-usetutoatupu>WSLからCAN通信を行うセットアップ<a aria-label="Anchor link for: wslkaracantong-xin-woxing-usetutoatupu" class=zola-anchor href=#wslkaracantong-xin-woxing-usetutoatupu style=visibility:hidden></a></h3><p>長くなりそう (+ 需要が多少はありそう笑) なので、別記事でまとめたいと思います。<p>簡単に書くとCAN関連のカーネルモジュールを入れたWSLのカスタムカーネルをビルドし、WSLからCAN bus analyzerを認識できるようにすればうまくいきました。<h3 id=yoctohenoyi-zhi>Yoctoへの移植<a aria-label="Anchor link for: yoctohenoyi-zhi" class=zola-anchor href=#yoctohenoyi-zhi style=visibility:hidden></a></h3><p>Yoctoはbitbakeというパッケージ管理システムを用いて組み込みLinuxをビルドします。 Linuxにほしい機能を追加するには、bitbakeが認識できるレシピを作成する必要があります。 今回作成したレイヤー・レシピは次のようになります。<details><summary><span>meta-mcp2517fd</span></summary> <p><a rel="nofollow noreferrer" href=https://github.com/spacecubics/scsat1-rpi/tree/main/zero/meta-mcp2517fd>このレイヤ</a>は、MCP2517FD用のデバイスツリーをYoctoでビルドするカーネルに組み込むものです。</p> <p>実際に追加するデバイス情報は下記の内容です。</p> <pre class=z-code><code><span class="z-text z-plain">/*
</span><span class="z-text z-plain"> * Device tree overlay for mcp2517fd/can0 on spi0.0
</span><span class="z-text z-plain"> */
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">/dts-v1/;
</span><span class="z-text z-plain">/plugin/;
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">/ {
</span><span class="z-text z-plain">    compatible = "brcm,bcm2835";
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    /* enable spi for spi0.0 */
</span><span class="z-text z-plain">    fragment@0 {
</span><span class="z-text z-plain">        target = <&spi0>;
</span><span class="z-text z-plain">        __overlay__ {
</span><span class="z-text z-plain">            status = "okay";
</span><span class="z-text z-plain">        };
</span><span class="z-text z-plain">    };
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    /* disable spi-dev for spi0.0 */
</span><span class="z-text z-plain">    fragment@1 {
</span><span class="z-text z-plain">        target = <&spidev0>;
</span><span class="z-text z-plain">        __overlay__ {
</span><span class="z-text z-plain">            status = "disabled";
</span><span class="z-text z-plain">        };
</span><span class="z-text z-plain">    };
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    /* the interrupt pin of mcp2517fd */
</span><span class="z-text z-plain">    fragment@2 {
</span><span class="z-text z-plain">        target = <&gpio>;
</span><span class="z-text z-plain">        __overlay__ {
</span><span class="z-text z-plain">            mcp2517fd_int_pin: mcp2517fd_int_pin {
</span><span class="z-text z-plain">                brcm,pins = &LT25>;       // use GPIO25 for interrupt pin
</span><span class="z-text z-plain">                brcm,function = &LT0>;    // BCM2835_FSEL_GPIO_IN
</span><span class="z-text z-plain">            };
</span><span class="z-text z-plain">        };
</span><span class="z-text z-plain">    };
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    /* the clock/oscillator of mcp2517fd */
</span><span class="z-text z-plain">    fragment@3 {
</span><span class="z-text z-plain">        target-path = "/clocks";
</span><span class="z-text z-plain">        __overlay__ {
</span><span class="z-text z-plain">            /* external oscillator of mcp2517fd on SPI0.0 */
</span><span class="z-text z-plain">            clk_mcp2517fd_osc: clk_mcp2517fd_osc {
</span><span class="z-text z-plain">                compatible = "fixed-clock";
</span><span class="z-text z-plain">                #clock-cells = &LT0>;
</span><span class="z-text z-plain">                clock-frequency  = &LT20000000>;  // use 20MHz oscillator
</span><span class="z-text z-plain">            };
</span><span class="z-text z-plain">        };
</span><span class="z-text z-plain">    };
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    /* the spi config of the can-controller itself binding everything together */
</span><span class="z-text z-plain">    fragment@4 {
</span><span class="z-text z-plain">        target = <&spi0>;
</span><span class="z-text z-plain">        __overlay__ {
</span><span class="z-text z-plain">            /* needed to avoid dtc warning */
</span><span class="z-text z-plain">            #address-cells = &LT1>;
</span><span class="z-text z-plain">            #size-cells = &LT0>;
</span><span class="z-text z-plain">            can0: mcp2517fd@0 {
</span><span class="z-text z-plain">                reg = &LT0>;
</span><span class="z-text z-plain">                compatible = "microchip,mcp2517fd";
</span><span class="z-text z-plain">                pinctrl-names = "default";
</span><span class="z-text z-plain">                pinctrl-0 = <&mcp2517fd_int_pin>;
</span><span class="z-text z-plain">                spi-max-frequency = &LT20000000>;     // up to 20MHz SPI clock speed on mcp2517fd
</span><span class="z-text z-plain">                interrupt-parent = <&gpio>;
</span><span class="z-text z-plain">                interrupts = &LT25 8>;                // IRQ_TYPE_LEVEL_LOW : active low
</span><span class="z-text z-plain">                clocks = <&clk_mcp2517fd_osc>;
</span><span class="z-text z-plain">            };
</span><span class="z-text z-plain">        };
</span><span class="z-text z-plain">    };
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">    __overrides__ {
</span><span class="z-text z-plain">        oscillator = <&clk_mcp2517fd_osc>,"clock-frequency:0";
</span><span class="z-text z-plain">        spimaxfrequency = <&can0>,"spi-max-frequency:0";
</span><span class="z-text z-plain">        interrupt = <&mcp2517fd_int_pin>,"brcm,pins:0",<&can0>,"interrupts:0";
</span><span class="z-text z-plain">    };
</span><span class="z-text z-plain">};
</span></code></pre> <p>このコードは、Linuxカーネル内の <code>mcp2515-overlay.dts</code> や <code>mcp251xfd-overlay.dts</code> を参考にして、今回必要な部分のみを取り出したものです。</p> <p>このファイルをRaspberryPiのLinuxをビルドするレシピ(<code>linux-raspberrypi_*.bb</code>)を実行する際に追加するように <code>.bbappend</code>ファイルを作成しました。</p> <pre class=z-code><code><span class="z-text z-plain">SRC_URI += "file://mcp2517fd-overlay.dts;subdir=git/arch/${ARCH}/boot/dts/overlays"
</span><span class="z-text z-plain">...
</span></code></pre> <p>対象のファイルをsubdirに配置できます。他にも、patchを用いた追加方法もあります。</p></details><details><summary><span>meta-libcsp</span></summary> <p><a rel="nofollow noreferrer" href=https://github.com/spacecubics/scsat1-rpi/tree/main/zero/meta-libcsp>このレイヤ</a>は、<a rel="nofollow noreferrer" href=https://github.com/libcsp/libcsp>libcsp</a> を使用するレシピのために共有ライブラリ・ヘッダファイルを作成するためのものです。</p> <p>今回ビルド対象は、github上にあるので、下記のようにレシピを書きgithubからクローンするようにしました。</p> <pre class=z-code><code><span class="z-text z-plain">SRCREV = "${AUTOREV}"
</span><span class="z-text z-plain">SRCBRANCH = "develop"
</span><span class="z-text z-plain">SRC_URI = "git://github.com/libcsp/libcsp.git;protocol=https;branch=${SRCBRANCH};"
</span></code></pre> <p>このレシピは、URLが示すリポジトリの <code>develop</code> ブランチの最新のコミットを取って来ます。 そして、ビルド方法にcmakeを指定することで、build → installまで行ってくれます (installターゲットがなければ当然実行されない)。</p> <pre class=z-code><code><span class="z-text z-plain">inherit cmake ...
</span></code></pre> <p>ビルド後のファイルの置き場所を指定する必要があるので、下記のように目的別に指定しました。</p> <pre class=z-code><code><span class="z-text z-plain">FILES:${PN}-dbg += "${libdir}/.debug"
</span><span class="z-text z-plain">FILES:${PN}     += "${libdir}/libcsp.so"
</span><span class="z-text z-plain">FILES:${PN}-dev += "${includedir}/csp"
</span></code></pre> <p>それぞれ、debug用、共有ライブラリ使用、ヘッダを使用する開発用と分けています。</p></details><details><summary><span>meta-csp (wip)</span></summary> <p><a rel="nofollow noreferrer" href=https://github.com/KantaTamura/scsat1-rpi/tree/wip/csp-app/zero/meta-csp>このレイヤ</a>は、libcspを使用したレシピのためのもので、現在開発途中です。</p> <p>現状は、<code>csp-server-client</code>のサーバ側と同様の機能を持つプログラムをsystemdで起動するところまで実装しています。 今後、ルータ機能やカメラコマンドを発火させる機能を増やしていく予定です。</p></details><details><summary><span>meta-arducam (wip)</span></summary> <p><a rel="nofollow noreferrer" href=https://github.com/spacecubics/scsat1-rpi/tree/wip/arducam/zero/meta-arducam>このレイヤ</a>は、Yoctoでビルドするカーネルでカメラモジュールを認識できるようにするための、カーネルモジュールとデバイスツリーを追加するためのもので、現在開発途中です。</p></details><h2 id=9yue-zhong>9月中<a aria-label="Anchor link for: 9yue-zhong" class=zola-anchor href=#9yue-zhong style=visibility:hidden></a></h2><h3 id=zha-huang-ohuisufang-wen>札幌オフィス訪問<a aria-label="Anchor link for: zha-huang-ohuisufang-wen" class=zola-anchor href=#zha-huang-ohuisufang-wen style=visibility:hidden></a></h3><p>インターン期間中space cubics札幌オフィスに招待されたので、3日間現地で作業しました！<p>札幌オフィスではlibcspをyoctoに移植する作業をしながら、"普段どんなソフトウェアを使って開発しているのか"や"pull requestを整理してマージする方法"など、現場で開発しているならではの話を聞いたり、僕がおすすめしているソフトウェアを紹介したりしていました。 個人開発では触ったことの無いgitコマンドなど、色々なことを教えていただき、とても楽しかったです。<p>オフィスは机の上にpic-kitなどが無造作においてあったり、オシロスコープや4Kディスプレイがそれぞれの机の上に備え付けられていたりと、個人的にとても理想的な作業環境だな...と憧れました笑<p>高専では同じような環境で作業していたのですが、大学に進学してからはハードウェアに触る機会は減って行ってしまったのでとても楽しかったです！<p>ご飯にもたくさん誘って頂いたので一部の記録を紹介します。<details><summary><span>オフィス訪問している間の写真など... (飯テロ注意！)</span></summary> <figure><img alt=札幌オフィス src=https://storage.googleapis.com/zenn-user-upload/34bd1d504d79-20231003.jpg><figcaption>space cubics札幌オフィス - 3部屋ほど借りられていて、今後部屋を合併するらしいです</figcaption></figure><figure><img alt=ジンギスカン src=https://storage.googleapis.com/zenn-user-upload/2c3fcb2634ed-20231114.jpg><figcaption>初日はジンギスカンを食べに行きました！ 初ジンギスカン美味しかったです！</figcaption></figure><figure><img alt=linuxビルド src=https://storage.googleapis.com/zenn-user-upload/bfdb0d5dd56c-20231114.jpg><figcaption>持ち込んだノートPCにWSL(enable CAN)をセットアップしてなかったので夜中にビルド</figcaption></figure><figure><img alt=スープカレー src=https://storage.googleapis.com/zenn-user-upload/fe790407a60a-20231114.jpg><figcaption>2日目お昼はスープカレーを食べました。スパイシーで美味しかったです！</figcaption></figure><figure><img alt=サンマ炊き込みご飯 src=https://storage.googleapis.com/zenn-user-upload/0ec8be27ff3e-20231114.jpg><figcaption>3日目(最終日)の晩ごはんで旬のサンマを食べました！</figcaption></figure></details><p>札幌オフィスでの作業は水木金の３日間だけでしたが、なんと追加で数日間のホテルも予約していただき、観光もすることができました！とてもありがたかったです！<details><summary><span>札幌観光</span></summary> <figure><img alt=夜パフェ src=https://storage.googleapis.com/zenn-user-upload/304d1d7a68b7-20231114.jpg><figcaption>札幌では夜パフェ(締めパフェ)が流行っているらしいです(22:00頃)</figcaption></figure><figure><img alt=AOAO src=https://storage.googleapis.com/zenn-user-upload/be932a19d3c6-20231114.jpg><figcaption>AOAOというきれいな水族館がホテルの近くにあったので観光</figcaption></figure><figure><img alt=藻岩山夜景 src=https://storage.googleapis.com/zenn-user-upload/2582511a75bb-20231114.jpg><figcaption>新日本3大夜景に選ばれた藻岩山山頂展望台からの景色です(極寒でした...)</figcaption></figure></details><p>とても充実した3日間(+1日)で、一瞬で過ぎ去ってしまってもっと作業していたかったな...と帰りの飛行機で思っていました。<h3 id=libcsphenokomituto>libcspへのコミット<a aria-label="Anchor link for: libcsphenokomituto" class=zola-anchor href=#libcsphenokomituto style=visibility:hidden></a></h3><p>yoctoのビルドではcmakeを使用するのですが、libcspのcmakeにはヘッダ・共有ライブラリをインストールする機能がなかったので、この部分を追加し、<a rel="nofollow noreferrer" href=https://github.com/libcsp/libcsp/pull/446>マージ</a>されました。<p>実際に書いたコード量は短いですが、linuxデフォルトの共有ライブラリロード方法やcmakeの複雑な記法など、ためになることがたくさんありました。<p>OSSへのコントリビューションの経験がなかったので、非常に良い経験をさせていただいてありがたかったです！<h1 id=xue-ndakoto>学んだこと<a aria-label="Anchor link for: xue-ndakoto" class=zola-anchor href=#xue-ndakoto style=visibility:hidden></a></h1><p>今回のインターンでは本当に知らないことが多く、下に調べて学んだことの一部を示します。<ul><li>DeviceTree (Overlay)<li>Kernel Module<li>Yocto (bitbake)<li>CAN</ul><p>他にも細々としたことを調査したりしていました。<p>インターン初日のミーティングで「はじめはわからないことが多いと思うから一日調査に使ってもいいよ」と言ってくださったので、わからないことは基本的に調べて実践を繰り返して学びました。 おそらく、ミーティングなどで直接聞けばみなさん既知の内容なので、快く教えてくださると思いますが、個人的に"調べる力"や"調べたい内容以外の知識を得られる<sup class=footnote-reference><a href=#3>3</a></sup>"ということが大切だと思い、"わからないことも自分で十分に調べて、それでも分からなければ聞く"ということを心がけました。<p>8月中旬などはずっと調べていて、あまり進捗がなかったですが、その経験が8月後半・9月での実装で非常に役立ちました。<h1 id=gan-xiang>感想<a aria-label="Anchor link for: gan-xiang" class=zola-anchor href=#gan-xiang style=visibility:hidden></a></h1><p>蓋を開けてみれば調べては実践の繰り返しをしていた2ヶ月間でしたが、知らない知識がたくさんあることやそれを学ぶ楽しさがたくさんありました。 カーネルや通信の仕組みなど、まだまだ知らないことが多く残っているので、これからも勉強しながら低レイヤー関連を触っていきたいです。<p>インターン期間中は、研究室のミーティングなどで予定変更が多かったのにも関わらず、調整してくださり、とてもありがたかったです。<p>ありがたいことに10月以降もお手伝いという形で続けることになりましたので、残りの実装を行っていきたいと思います！ (10月はCSP用のwireshark dissectorを書いたりしていました)<p>来年以降に和歌山で打ち上げ予定とのことなので、ぜひ実際に見てみたいです！<h3 id=zhui-ji-kun-tutakoto>追記 - 困ったこと<a aria-label="Anchor link for: zhui-ji-kun-tutakoto" class=zola-anchor href=#zhui-ji-kun-tutakoto style=visibility:hidden></a></h3><p>困ったことはほとんどありませんでしたが、強いて言うなら来年以降、インターン用の応募欄をホームページに作成していただけると、応募の際のハードルが下がって良いかな？と思いました。<h1 id=owarini>おわりに<a aria-label="Anchor link for: owarini" class=zola-anchor href=#owarini style=visibility:hidden></a></h1><p>来年もサマーインターンを募集するみたいなので、興味を持っていただいた方はぜひ応募してみてください！<p>最後になりますがインターンを受け入れていただいたspace cubicsの皆様、本当にありがとうございます！もう少しお世話になります！<hr><div class=footnote-definition id=1><sup class=footnote-definition-label>1</sup><p>RaspberryPi Zeroはカメラ撮影とメインのコンピュータからの通信を自身とPicoに振り分けるルータ的役割を持っている。</div><div class=footnote-definition id=2><sup class=footnote-definition-label>2</sup><p>RsapberryPi Picoは温度センサを監視する役割を持っている。</div><div class=footnote-definition id=3><sup class=footnote-definition-label>3</sup><p>例えば、DeviceTreeを調べている過程でKernelがどのようにロードしていくのか...といったことが学べました。</div></article><div class=giscus></div><script async crossorigin data-category=Announcements data-category-id=DIC_kwDOLFJbf84Cch_z data-emit-metadata=0 data-input-position=top data-lang=ja data-loading=lazy data-mapping=title data-reactions-enabled=1 data-repo=KantaTamura/KantaTamura.github.io data-repo-id=R_kgDOLFJbfw data-strict=0 data-theme=preferred_color_scheme src=https://giscus.app/client.js></script></div><footer><div class=copyright><p>© 2025 KantaTamura</div></footer></main></div><script src=/js/lightense.min.js></script><script type=module>import a from"https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";a.initialize({startOnLoad:!0})</script><script src=/js/main.js></script>